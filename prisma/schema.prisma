generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mongodb"
  url      = env("DATABASE_URL")
}

enum Role {
  Student
  Benefactor
  SystemAdmin
}

model User {
  id         String  @id @default(auto()) @map("_id") @db.ObjectId
  email      String  @unique
  name       String?
  profilePic String?
  role       Role    @default(Student)

  userInfo UserInfo?
}

model UserInfo {
  id     String @id @default(auto()) @map("_id") @db.ObjectId
  user   User   @relation(fields: [userId], references: [id])
  userId String @unique @db.ObjectId

  benefactorInfo BenefactorInfo?
  studentInfo    StudentInfo?
}

// STUDENT
model StudentInfo {
  id String @id @default(auto()) @map("_id") @db.ObjectId

  user   UserInfo @relation(fields: [userId], references: [id])
  userId String   @unique @db.ObjectId
}

// BENEFACTOR
model BenefactorInfo {
  id                String        @id @default(auto()) @map("_id") @db.ObjectId
  universityProfile University?
  visits            Int           @default(0)
  favorites         Int           @default(0)
  scholarships      Scholarship[]

  phone             String
  staffID           String
  staffIDPic        String
  approved          Boolean       @default(false)

  user   UserInfo @relation(fields: [userId], references: [id])
  userId String   @unique @db.ObjectId
}

model University {
  id       String @id @default(auto()) @map("_id") @db.ObjectId
  name     String
  location String

  info   BenefactorInfo @relation(fields: [infoId], references: [id])
  infoId String         @unique @db.ObjectId
}

enum Benefits {
  Full
  Partial
  Allowance
}

model Scholarship {
  id             String     @id @default(auto()) @map("_id") @db.ObjectId
  title          String
  description    String
  qualifications String
  requirements   String
  procedures     String
  deadline       DateTime
  benefits       Benefits[]

  info   BenefactorInfo @relation(fields: [infoId], references: [id])
  infoId String         @unique @db.ObjectId
}
